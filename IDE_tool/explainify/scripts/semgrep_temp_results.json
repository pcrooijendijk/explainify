{"version":"1.139.0","results":[{"check_id":"java.lang.security.xxe.documentbuilderfactory-xxe-parameter-entity.documentbuilderfactory-xxe-parameter-entity","path":"/Users/prooijendijk/Documents/explainify/java_dataset/java_files/AbstractSAMLCallbackHandler.java","start":{"line":203,"col":36,"offset":7979},"end":{"line":204,"col":53,"offset":8052},"extra":{"metavars":{"$FACTORY":{"start":{"line":203,"col":36,"offset":7979},"end":{"line":203,"col":53,"offset":7996},"abstract_content":"docBuilderFactory"},"$PARSER":{"start":{"line":206,"col":29,"offset":8137},"end":{"line":206,"col":39,"offset":8147},"abstract_content":"docBuilder"}},"message":"The application is using an XML parser that has not been safely configured. This might lead to XML External Entity (XXE) vulnerabilities when parsing user-controlled input. An attacker can include document type definitions (DTDs) which can interact with internal or external hosts. XXE can lead to other vulnerabilities, such as Local File Inclusion (LFI), Remote Code Execution (RCE), and Server-side request forgery (SSRF), depending on the application configuration. An attacker can also use DTDs to expand recursively, leading to a Denial-of-Service (DoS) attack, also known as a Billion Laughs Attack. The current configuration allows for XXE attacks through parameter entities. It is our recommendation to secure this parser against XXE attacks by configuring docBuilderFactory with `docBuilderFactory.setFeature(http://apache.org/xml/features/disallow-doctype- decl, true)`. Alternatively, the following configurations also provide protection against XXE attacks with parameter entities. `docBuilderFactory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true)` `docBuilderFactory.setAttribute(XMLConstants.ACCESS_EXTERNAL_DTD, \"\")` `docBuilderFactory.setFeature(\"http://xml.org/ sax/features/external-parameter-entities\", false)` Beware, using a custom EntityResolver will render these settings useless and you will be responsible for handeling security in the implementation of you EntityResolver. For more information, see: [Java XXE prevention](https://semgrep.dev/docs/cheat- sheets/java-xxe/)","metadata":{"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"MEDIUM","category":"security","subcategory":["vuln"],"cwe":["CWE-611: Improper Restriction of XML External Entity Reference","CWE-776: Improper Restriction of Recursive Entity References in DTDs ('XML Entity Expansion')"],"functional-categories":["xml::sink::xml-parser::javax.xml"],"owasp":["A04:2017 - XML External Entities (XXE)","A05:2021 - Security Misconfiguration","A02:2025 - Security Misconfiguration"],"references":["https://semgrep.dev/blog/2022/xml-security-in-java","https://semgrep.dev/docs/cheat-sheets/java-xxe/","https://docs.oracle.com/en/java/javase/13/security/java-api-xml-processing-jaxp-security-guide.html#GUID-D97A1F1D-8DDF-4D19-A7E5-99099F27346E","https://github.com/semgrep/java-xxe-research","https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html","https://rules.sonarsource.com/java/type/Vulnerability/RSPEC-2755","https://blog.sonarsource.com/secure-xml-processor/","https://blog.sonarsource.com/understanding-xxe-vulnerabilities/","https://cwe.mitre.org/data/definitions/776.html","https://cwe.mitre.org/data/definitions/776.html"],"technology":["java"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["XML Injection"],"source":"https://semgrep.dev/r/java.lang.security.xxe.documentbuilderfactory-xxe-parameter-entity.documentbuilderfactory-xxe-parameter-entity","shortlink":"https://sg.run/5qYX","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":27147,"rule_id":"nJU2Wq","rv_id":1236412,"url":"https://semgrep.dev/playground/r/w8TRvEn/java.lang.security.xxe.documentbuilderfactory-xxe-parameter-entity.documentbuilderfactory-xxe-parameter-entity","version_id":"w8TRvEn"}}},"severity":"ERROR","fingerprint":"a4da3cc42ebc3965f6fb276876907550c2da2a6d3235d9a4367e9a4b4870ba17917c29090d74ac9ce2ccc62028530e425b364151938b2466fec43afa8c63effa_0","lines":"            DocumentBuilderFactory docBuilderFactory = \n                DocumentBuilderFactory.newInstance();","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"java.lang.security.xxe.documentbuilderfactory-xxe.documentbuilderfactory-xxe","path":"/Users/prooijendijk/Documents/explainify/java_dataset/java_files/AbstractSAMLCallbackHandler.java","start":{"line":203,"col":36,"offset":7979},"end":{"line":204,"col":53,"offset":8052},"extra":{"metavars":{"$FACTORY":{"start":{"line":203,"col":36,"offset":7979},"end":{"line":203,"col":53,"offset":7996},"abstract_content":"docBuilderFactory"},"$PARSER":{"start":{"line":206,"col":29,"offset":8137},"end":{"line":206,"col":39,"offset":8147},"abstract_content":"docBuilder"}},"message":"The application is using an XML parser that has not been safely configured. This might lead to XML External Entity (XXE) vulnerabilities when parsing user-controlled input. An attacker can include document type definitions (DTDs) which can interact with internal or external hosts. XXE can lead to other vulnerabilities, such as Local File Inclusion (LFI), Remote Code Execution (RCE), and Server-side request forgery (SSRF), depending on the application configuration. An attacker can also use DTDs to expand recursively, leading to a Denial-of- Service (DoS) attack, also known as a Billion Laughs Attack. It is our recommendation to secure this parser against XXE attacks by configuring docBuilderFactory with `docBuilderFactory.setFeature(http:// apache.org/ xml/features/disallow-doctype-decl, true)`. Alternatively, the following configurations also provide protection against XXE attacks. `docBuilderFactory.setExpandEntityReferences(false)` `docBuilderFactory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true)` `docBuilderFactory.setAttribute(XMLConstants.ACCESS_EXTERNAL_DTD, \"\")` `docBuilderFactory.setFeature(\"http://xml.org/ sax/features/external-general-entities\", false)`. For more information, see: [Java XXE prevention] (https://semgrep.dev/docs/cheat-sheets/java-xxe/)","metadata":{"likelihood":"MEDIUM","impact":"HIGH","confidence":"MEDIUM","category":"security","subcategory":["vuln"],"cwe":["CWE-611: Improper Restriction of XML External Entity Reference","CWE-776: Improper Restriction of Recursive Entity References in DTDs ('XML Entity Expansion')"],"functional-categories":["xml::sink::xml-parser::javax.xml"],"owasp":["A04:2017 - XML External Entities (XXE)","A05:2021 - Security Misconfiguration","A02:2025 - Security Misconfiguration"],"references":["https://semgrep.dev/blog/2022/xml-security-in-java","https://semgrep.dev/docs/cheat-sheets/java-xxe/","https://docs.oracle.com/en/java/javase/13/security/java-api-xml-processing-jaxp-security-guide.html#GUID-D97A1F1D-8DDF-4D19-A7E5-99099F27346E","https://github.com/semgrep/java-xxe-research","https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html","https://rules.sonarsource.com/java/type/Vulnerability/RSPEC-2755","https://blog.sonarsource.com/secure-xml-processor/","https://blog.sonarsource.com/understanding-xxe-vulnerabilities/","https://cwe.mitre.org/data/definitions/776.html","https://cwe.mitre.org/data/definitions/776.html"],"technology":["java"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["XML Injection"],"source":"https://semgrep.dev/r/java.lang.security.xxe.documentbuilderfactory-xxe.documentbuilderfactory-xxe","shortlink":"https://sg.run/GJd2","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":27148,"rule_id":"EwUEj8","rv_id":1236414,"url":"https://semgrep.dev/playground/r/O9Tpr9p/java.lang.security.xxe.documentbuilderfactory-xxe.documentbuilderfactory-xxe","version_id":"O9Tpr9p"}}},"severity":"ERROR","fingerprint":"9ec11c212f63c19cff2cb012e10e2d1189b79c0f67a4ac70f700bfb936aa2a2595917c136fb33dce35416f39a2b0bc80b42876443bdb0efcd9e4fc93539a2f8b_0","lines":"            DocumentBuilderFactory docBuilderFactory = \n                DocumentBuilderFactory.newInstance();","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"java.lang.security.audit.xxe.documentbuilderfactory-disallow-doctype-decl-missing.documentbuilderfactory-disallow-doctype-decl-missing","path":"/Users/prooijendijk/Documents/explainify/java_dataset/java_files/AbstractSAMLCallbackHandler.java","start":{"line":206,"col":13,"offset":8121},"end":{"line":206,"col":81,"offset":8189},"extra":{"metavars":{"$FACTORY":{"start":{"line":203,"col":36,"offset":7979},"end":{"line":203,"col":53,"offset":7996},"abstract_content":"docBuilderFactory"}},"message":"DOCTYPE declarations are enabled for this DocumentBuilderFactory. This is vulnerable to XML external entity attacks. Disable this by setting the feature \"http://apache.org/xml/features/disallow-doctype-decl\" to true. Alternatively, allow DOCTYPE declarations and only prohibit external entities declarations. This can be done by setting the features \"http://xml.org/sax/features/external-general-entities\" and \"http://xml.org/sax/features/external-parameter-entities\" to false.","fix":"docBuilderFactory.setFeature(\"http://apache.org/xml/features/disallow-doctype-decl\", true);\n            docBuilderFactory.newDocumentBuilder();","metadata":{"cwe":["CWE-611: Improper Restriction of XML External Entity Reference"],"owasp":["A04:2017 - XML External Entities (XXE)","A05:2021 - Security Misconfiguration","A02:2025 - Security Misconfiguration"],"asvs":{"control_id":"5.5.2 Insecue XML Deserialization","control_url":"https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v55-deserialization-prevention","section":"V5 Validation, Sanitization and Encoding","version":"4"},"references":["https://semgrep.dev/blog/2022/xml-security-in-java","https://semgrep.dev/docs/cheat-sheets/java-xxe/","https://blog.sonarsource.com/secure-xml-processor","https://xerces.apache.org/xerces2-j/features.html"],"category":"security","technology":["java","xml"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"LOW","impact":"HIGH","confidence":"HIGH","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["XML Injection"],"source":"https://semgrep.dev/r/java.lang.security.audit.xxe.documentbuilderfactory-disallow-doctype-decl-missing.documentbuilderfactory-disallow-doctype-decl-missing","shortlink":"https://sg.run/PYBz","semgrep.dev":{"rule":{"origin":"community","r_id":18245,"rule_id":"10UPQB","rv_id":1263058,"url":"https://semgrep.dev/playground/r/K3TKk80/java.lang.security.audit.xxe.documentbuilderfactory-disallow-doctype-decl-missing.documentbuilderfactory-disallow-doctype-decl-missing","version_id":"K3TKk80"}}},"severity":"ERROR","fingerprint":"5bfb2914cc5c046f50d59434482b45d6e7f49f4a8c4dd71561b8aaf3fb2518ebeacf27b6e6f340b0773d800f9e8eeb5023466f4793586e19295172564c7f60a5_0","lines":"            DocumentBuilder docBuilder = docBuilderFactory.newDocumentBuilder();","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"/Users/prooijendijk/Documents/explainify/java_dataset/java_files/AbstractSAMLCallbackHandler.java","start":{"line":203,"col":13,"offset":7956},"end":{"line":204,"col":54,"offset":8053}},"DocumentBuilderFactory docBuilderFactory = \n                DocumentBuilderFactory.newInstance();"]],"intermediate_vars":[{"location":{"path":"/Users/prooijendijk/Documents/explainify/java_dataset/java_files/AbstractSAMLCallbackHandler.java","start":{"line":203,"col":36,"offset":7979},"end":{"line":203,"col":53,"offset":7996}},"content":"docBuilderFactory"}],"taint_sink":["CliLoc",[{"path":"/Users/prooijendijk/Documents/explainify/java_dataset/java_files/AbstractSAMLCallbackHandler.java","start":{"line":206,"col":13,"offset":8121},"end":{"line":206,"col":81,"offset":8189}},"DocumentBuilder docBuilder = docBuilderFactory.newDocumentBuilder();"]]},"engine_kind":"OSS"}},{"check_id":"java.lang.security.xxe.documentbuilderfactory-xxe-parameter-entity.documentbuilderfactory-xxe-parameter-entity","path":"/Users/prooijendijk/Documents/explainify/java_dataset/java_files/CombinedValidatorTest.java","start":{"line":160,"col":32,"offset":7104},"end":{"line":160,"col":88,"offset":7160},"extra":{"metavars":{"$FACTORY":{"start":{"line":160,"col":32,"offset":7104},"end":{"line":160,"col":49,"offset":7121},"abstract_content":"docBuilderFactory"},"$PARSER":{"start":{"line":162,"col":25,"offset":7237},"end":{"line":162,"col":35,"offset":7247},"abstract_content":"docBuilder"}},"message":"The application is using an XML parser that has not been safely configured. This might lead to XML External Entity (XXE) vulnerabilities when parsing user-controlled input. An attacker can include document type definitions (DTDs) which can interact with internal or external hosts. XXE can lead to other vulnerabilities, such as Local File Inclusion (LFI), Remote Code Execution (RCE), and Server-side request forgery (SSRF), depending on the application configuration. An attacker can also use DTDs to expand recursively, leading to a Denial-of-Service (DoS) attack, also known as a Billion Laughs Attack. The current configuration allows for XXE attacks through parameter entities. It is our recommendation to secure this parser against XXE attacks by configuring docBuilderFactory with `docBuilderFactory.setFeature(http://apache.org/xml/features/disallow-doctype- decl, true)`. Alternatively, the following configurations also provide protection against XXE attacks with parameter entities. `docBuilderFactory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true)` `docBuilderFactory.setAttribute(XMLConstants.ACCESS_EXTERNAL_DTD, \"\")` `docBuilderFactory.setFeature(\"http://xml.org/ sax/features/external-parameter-entities\", false)` Beware, using a custom EntityResolver will render these settings useless and you will be responsible for handeling security in the implementation of you EntityResolver. For more information, see: [Java XXE prevention](https://semgrep.dev/docs/cheat- sheets/java-xxe/)","metadata":{"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"MEDIUM","category":"security","subcategory":["vuln"],"cwe":["CWE-611: Improper Restriction of XML External Entity Reference","CWE-776: Improper Restriction of Recursive Entity References in DTDs ('XML Entity Expansion')"],"functional-categories":["xml::sink::xml-parser::javax.xml"],"owasp":["A04:2017 - XML External Entities (XXE)","A05:2021 - Security Misconfiguration","A02:2025 - Security Misconfiguration"],"references":["https://semgrep.dev/blog/2022/xml-security-in-java","https://semgrep.dev/docs/cheat-sheets/java-xxe/","https://docs.oracle.com/en/java/javase/13/security/java-api-xml-processing-jaxp-security-guide.html#GUID-D97A1F1D-8DDF-4D19-A7E5-99099F27346E","https://github.com/semgrep/java-xxe-research","https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html","https://rules.sonarsource.com/java/type/Vulnerability/RSPEC-2755","https://blog.sonarsource.com/secure-xml-processor/","https://blog.sonarsource.com/understanding-xxe-vulnerabilities/","https://cwe.mitre.org/data/definitions/776.html","https://cwe.mitre.org/data/definitions/776.html"],"technology":["java"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["XML Injection"],"source":"https://semgrep.dev/r/java.lang.security.xxe.documentbuilderfactory-xxe-parameter-entity.documentbuilderfactory-xxe-parameter-entity","shortlink":"https://sg.run/5qYX","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":27147,"rule_id":"nJU2Wq","rv_id":1236412,"url":"https://semgrep.dev/playground/r/w8TRvEn/java.lang.security.xxe.documentbuilderfactory-xxe-parameter-entity.documentbuilderfactory-xxe-parameter-entity","version_id":"w8TRvEn"}}},"severity":"ERROR","fingerprint":"aaf5067efd6eb3b643d7327617e49fb515c1b8d0914204dd04b4690cd169f96fea617d86afdf5f4cb95732554641dc6da99e86f1ed0fe9c36ebdda9a45810cc5_0","lines":"        DocumentBuilderFactory docBuilderFactory = DocumentBuilderFactory.newInstance();","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"java.lang.security.xxe.documentbuilderfactory-xxe.documentbuilderfactory-xxe","path":"/Users/prooijendijk/Documents/explainify/java_dataset/java_files/CombinedValidatorTest.java","start":{"line":160,"col":32,"offset":7104},"end":{"line":160,"col":88,"offset":7160},"extra":{"metavars":{"$FACTORY":{"start":{"line":160,"col":32,"offset":7104},"end":{"line":160,"col":49,"offset":7121},"abstract_content":"docBuilderFactory"},"$PARSER":{"start":{"line":162,"col":25,"offset":7237},"end":{"line":162,"col":35,"offset":7247},"abstract_content":"docBuilder"}},"message":"The application is using an XML parser that has not been safely configured. This might lead to XML External Entity (XXE) vulnerabilities when parsing user-controlled input. An attacker can include document type definitions (DTDs) which can interact with internal or external hosts. XXE can lead to other vulnerabilities, such as Local File Inclusion (LFI), Remote Code Execution (RCE), and Server-side request forgery (SSRF), depending on the application configuration. An attacker can also use DTDs to expand recursively, leading to a Denial-of- Service (DoS) attack, also known as a Billion Laughs Attack. It is our recommendation to secure this parser against XXE attacks by configuring docBuilderFactory with `docBuilderFactory.setFeature(http:// apache.org/ xml/features/disallow-doctype-decl, true)`. Alternatively, the following configurations also provide protection against XXE attacks. `docBuilderFactory.setExpandEntityReferences(false)` `docBuilderFactory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true)` `docBuilderFactory.setAttribute(XMLConstants.ACCESS_EXTERNAL_DTD, \"\")` `docBuilderFactory.setFeature(\"http://xml.org/ sax/features/external-general-entities\", false)`. For more information, see: [Java XXE prevention] (https://semgrep.dev/docs/cheat-sheets/java-xxe/)","metadata":{"likelihood":"MEDIUM","impact":"HIGH","confidence":"MEDIUM","category":"security","subcategory":["vuln"],"cwe":["CWE-611: Improper Restriction of XML External Entity Reference","CWE-776: Improper Restriction of Recursive Entity References in DTDs ('XML Entity Expansion')"],"functional-categories":["xml::sink::xml-parser::javax.xml"],"owasp":["A04:2017 - XML External Entities (XXE)","A05:2021 - Security Misconfiguration","A02:2025 - Security Misconfiguration"],"references":["https://semgrep.dev/blog/2022/xml-security-in-java","https://semgrep.dev/docs/cheat-sheets/java-xxe/","https://docs.oracle.com/en/java/javase/13/security/java-api-xml-processing-jaxp-security-guide.html#GUID-D97A1F1D-8DDF-4D19-A7E5-99099F27346E","https://github.com/semgrep/java-xxe-research","https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html","https://rules.sonarsource.com/java/type/Vulnerability/RSPEC-2755","https://blog.sonarsource.com/secure-xml-processor/","https://blog.sonarsource.com/understanding-xxe-vulnerabilities/","https://cwe.mitre.org/data/definitions/776.html","https://cwe.mitre.org/data/definitions/776.html"],"technology":["java"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["XML Injection"],"source":"https://semgrep.dev/r/java.lang.security.xxe.documentbuilderfactory-xxe.documentbuilderfactory-xxe","shortlink":"https://sg.run/GJd2","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":27148,"rule_id":"EwUEj8","rv_id":1236414,"url":"https://semgrep.dev/playground/r/O9Tpr9p/java.lang.security.xxe.documentbuilderfactory-xxe.documentbuilderfactory-xxe","version_id":"O9Tpr9p"}}},"severity":"ERROR","fingerprint":"eda0fb9bb6ed2384502f108b96bfd593c03e56cb207ac313f65603d89db2eb5384be51956af3ede9895c9bdb7388022b1d2948b3ae4e1e5ff20862b13ef561ac_0","lines":"        DocumentBuilderFactory docBuilderFactory = DocumentBuilderFactory.newInstance();","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"java.lang.security.audit.xxe.documentbuilderfactory-disallow-doctype-decl-missing.documentbuilderfactory-disallow-doctype-decl-missing","path":"/Users/prooijendijk/Documents/explainify/java_dataset/java_files/CombinedValidatorTest.java","start":{"line":162,"col":9,"offset":7221},"end":{"line":162,"col":77,"offset":7289},"extra":{"metavars":{"$FACTORY":{"start":{"line":160,"col":32,"offset":7104},"end":{"line":160,"col":49,"offset":7121},"abstract_content":"docBuilderFactory"}},"message":"DOCTYPE declarations are enabled for this DocumentBuilderFactory. This is vulnerable to XML external entity attacks. Disable this by setting the feature \"http://apache.org/xml/features/disallow-doctype-decl\" to true. Alternatively, allow DOCTYPE declarations and only prohibit external entities declarations. This can be done by setting the features \"http://xml.org/sax/features/external-general-entities\" and \"http://xml.org/sax/features/external-parameter-entities\" to false.","fix":"docBuilderFactory.setFeature(\"http://apache.org/xml/features/disallow-doctype-decl\", true);\n        docBuilderFactory.newDocumentBuilder();","metadata":{"cwe":["CWE-611: Improper Restriction of XML External Entity Reference"],"owasp":["A04:2017 - XML External Entities (XXE)","A05:2021 - Security Misconfiguration","A02:2025 - Security Misconfiguration"],"asvs":{"control_id":"5.5.2 Insecue XML Deserialization","control_url":"https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v55-deserialization-prevention","section":"V5 Validation, Sanitization and Encoding","version":"4"},"references":["https://semgrep.dev/blog/2022/xml-security-in-java","https://semgrep.dev/docs/cheat-sheets/java-xxe/","https://blog.sonarsource.com/secure-xml-processor","https://xerces.apache.org/xerces2-j/features.html"],"category":"security","technology":["java","xml"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"LOW","impact":"HIGH","confidence":"HIGH","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["XML Injection"],"source":"https://semgrep.dev/r/java.lang.security.audit.xxe.documentbuilderfactory-disallow-doctype-decl-missing.documentbuilderfactory-disallow-doctype-decl-missing","shortlink":"https://sg.run/PYBz","semgrep.dev":{"rule":{"origin":"community","r_id":18245,"rule_id":"10UPQB","rv_id":1263058,"url":"https://semgrep.dev/playground/r/K3TKk80/java.lang.security.audit.xxe.documentbuilderfactory-disallow-doctype-decl-missing.documentbuilderfactory-disallow-doctype-decl-missing","version_id":"K3TKk80"}}},"severity":"ERROR","fingerprint":"19adbb8a37eb71d2fc7947bd5c4908c50906bb278ec760a7b183cf4d4b0f5a03e1ef5f1e286d2ee528b56afbe3d7565f90cb6db1e992d0516b0fd8a6199b970f_0","lines":"        DocumentBuilder docBuilder = docBuilderFactory.newDocumentBuilder();","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"/Users/prooijendijk/Documents/explainify/java_dataset/java_files/CombinedValidatorTest.java","start":{"line":160,"col":9,"offset":7081},"end":{"line":160,"col":89,"offset":7161}},"DocumentBuilderFactory docBuilderFactory = DocumentBuilderFactory.newInstance();"]],"intermediate_vars":[{"location":{"path":"/Users/prooijendijk/Documents/explainify/java_dataset/java_files/CombinedValidatorTest.java","start":{"line":160,"col":32,"offset":7104},"end":{"line":160,"col":49,"offset":7121}},"content":"docBuilderFactory"}],"taint_sink":["CliLoc",[{"path":"/Users/prooijendijk/Documents/explainify/java_dataset/java_files/CombinedValidatorTest.java","start":{"line":162,"col":9,"offset":7221},"end":{"line":162,"col":77,"offset":7289}},"DocumentBuilder docBuilder = docBuilderFactory.newDocumentBuilder();"]]},"engine_kind":"OSS"}},{"check_id":"java.lang.security.audit.object-deserialization.object-deserialization","path":"/Users/prooijendijk/Documents/explainify/java_dataset/java_files/DiskFileItemSerializeTest.java","start":{"line":256,"col":9,"offset":8974},"end":{"line":256,"col":61,"offset":9026},"extra":{"metavars":{},"message":"Found object deserialization using ObjectInputStream. Deserializing entire Java objects is dangerous because malicious actors can create Java object streams with unintended consequences. Ensure that the objects being deserialized are not user-controlled. If this must be done, consider using HMACs to sign the data stream to make sure it is not tampered with, or consider only transmitting object fields and populating a new object.","metadata":{"cwe":["CWE-502: Deserialization of Untrusted Data"],"owasp":["A08:2017 - Insecure Deserialization","A08:2021 - Software and Data Integrity Failures","A08:2025 - Software or Data Integrity Failures"],"source-rule-url":"https://find-sec-bugs.github.io/bugs.htm#OBJECT_DESERIALIZATION","references":["https://www.owasp.org/index.php/Deserialization_of_untrusted_data","https://www.oracle.com/java/technologies/javase/seccodeguide.html#8"],"category":"security","technology":["java"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["audit"],"likelihood":"LOW","impact":"HIGH","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Insecure Deserialization "],"source":"https://semgrep.dev/r/java.lang.security.audit.object-deserialization.object-deserialization","shortlink":"https://sg.run/Ek0A","semgrep.dev":{"rule":{"origin":"community","r_id":9181,"rule_id":"GdU7py","rv_id":1263030,"url":"https://semgrep.dev/playground/r/NdTzyGe/java.lang.security.audit.object-deserialization.object-deserialization","version_id":"NdTzyGe"}}},"severity":"WARNING","fingerprint":"a4b3dc1ab84faf600b78a4f80e076135e2f6b51768addd168845f17827ddc2b7fa5e378ef92846b5165b3b0741251377f6d1ec9426b73b6033bbcd85d7e99587_0","lines":"        ObjectInputStream ois = new ObjectInputStream(bais);","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"java.lang.security.audit.active-debug-code-printstacktrace.active-debug-code-printstacktrace","path":"/Users/prooijendijk/Documents/explainify/java_dataset/java_files/SAXDocumentFactory.java","start":{"line":407,"col":13,"offset":12892},"end":{"line":407,"col":32,"offset":12911},"extra":{"metavars":{"$EXCEPTION":{"start":{"line":407,"col":13,"offset":12892},"end":{"line":407,"col":14,"offset":12893},"abstract_content":"e"}},"message":"Possible active debug code detected. Deploying an application with debug code can create unintended entry points or expose sensitive information.","metadata":{"likelihood":"LOW","impact":"LOW","confidence":"MEDIUM","category":"security","subcategory":["audit"],"cwe":["CWE-489: Active Debug Code"],"functional-categories":["debug::search::active-debug-code::java.lang"],"owasp":["A10:2004 - Insecure Configuration Management","A06:2017 - Security Misconfiguration","A05:2021 - Security Misconfiguration","A02:2025 - Security Misconfiguration"],"references":["https://cwe.mitre.org/data/definitions/489.html","https://www.acunetix.com/vulnerabilities/web/stack-trace-disclosure-java/","https://owasp.org/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/08-Testing_for_Error_Handling/02-Testing_for_Stack_Traces","https://www.securecodewarrior.com/blog/coders-conquer-security-share-learn-series-information-exposure"],"technology":["java"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Active Debug Code"],"source":"https://semgrep.dev/r/java.lang.security.audit.active-debug-code-printstacktrace.active-debug-code-printstacktrace","shortlink":"https://sg.run/4K8z","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":27144,"rule_id":"v8U0rZ","rv_id":1236400,"url":"https://semgrep.dev/playground/r/zyTb9Oq/java.lang.security.audit.active-debug-code-printstacktrace.active-debug-code-printstacktrace","version_id":"zyTb9Oq"}}},"severity":"WARNING","fingerprint":"a831f9c99505ae5c422c555c991cf84f39d7b00dd2871e4186b9b19999ea4d807452d60d731ca8fd1f23bc87a07675a49525e1ec7879735f40f4775da52e9cef_0","lines":"            e.printStackTrace();","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"java.lang.security.audit.active-debug-code-printstacktrace.active-debug-code-printstacktrace","path":"/Users/prooijendijk/Documents/explainify/java_dataset/java_files/SAXDocumentFactory.java","start":{"line":409,"col":13,"offset":12972},"end":{"line":409,"col":32,"offset":12991},"extra":{"metavars":{"$EXCEPTION":{"start":{"line":409,"col":13,"offset":12972},"end":{"line":409,"col":14,"offset":12973},"abstract_content":"e"}},"message":"Possible active debug code detected. Deploying an application with debug code can create unintended entry points or expose sensitive information.","metadata":{"likelihood":"LOW","impact":"LOW","confidence":"MEDIUM","category":"security","subcategory":["audit"],"cwe":["CWE-489: Active Debug Code"],"functional-categories":["debug::search::active-debug-code::java.lang"],"owasp":["A10:2004 - Insecure Configuration Management","A06:2017 - Security Misconfiguration","A05:2021 - Security Misconfiguration","A02:2025 - Security Misconfiguration"],"references":["https://cwe.mitre.org/data/definitions/489.html","https://www.acunetix.com/vulnerabilities/web/stack-trace-disclosure-java/","https://owasp.org/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/08-Testing_for_Error_Handling/02-Testing_for_Stack_Traces","https://www.securecodewarrior.com/blog/coders-conquer-security-share-learn-series-information-exposure"],"technology":["java"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Active Debug Code"],"source":"https://semgrep.dev/r/java.lang.security.audit.active-debug-code-printstacktrace.active-debug-code-printstacktrace","shortlink":"https://sg.run/4K8z","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":27144,"rule_id":"v8U0rZ","rv_id":1236400,"url":"https://semgrep.dev/playground/r/zyTb9Oq/java.lang.security.audit.active-debug-code-printstacktrace.active-debug-code-printstacktrace","version_id":"zyTb9Oq"}}},"severity":"WARNING","fingerprint":"a831f9c99505ae5c422c555c991cf84f39d7b00dd2871e4186b9b19999ea4d807452d60d731ca8fd1f23bc87a07675a49525e1ec7879735f40f4775da52e9cef_1","lines":"            e.printStackTrace();","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"java.lang.security.audit.active-debug-code-printstacktrace.active-debug-code-printstacktrace","path":"/Users/prooijendijk/Documents/explainify/java_dataset/java_files/SAXDocumentFactory.java","start":{"line":411,"col":13,"offset":13056},"end":{"line":411,"col":32,"offset":13075},"extra":{"metavars":{"$EXCEPTION":{"start":{"line":411,"col":13,"offset":13056},"end":{"line":411,"col":14,"offset":13057},"abstract_content":"e"}},"message":"Possible active debug code detected. Deploying an application with debug code can create unintended entry points or expose sensitive information.","metadata":{"likelihood":"LOW","impact":"LOW","confidence":"MEDIUM","category":"security","subcategory":["audit"],"cwe":["CWE-489: Active Debug Code"],"functional-categories":["debug::search::active-debug-code::java.lang"],"owasp":["A10:2004 - Insecure Configuration Management","A06:2017 - Security Misconfiguration","A05:2021 - Security Misconfiguration","A02:2025 - Security Misconfiguration"],"references":["https://cwe.mitre.org/data/definitions/489.html","https://www.acunetix.com/vulnerabilities/web/stack-trace-disclosure-java/","https://owasp.org/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/08-Testing_for_Error_Handling/02-Testing_for_Stack_Traces","https://www.securecodewarrior.com/blog/coders-conquer-security-share-learn-series-information-exposure"],"technology":["java"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Active Debug Code"],"source":"https://semgrep.dev/r/java.lang.security.audit.active-debug-code-printstacktrace.active-debug-code-printstacktrace","shortlink":"https://sg.run/4K8z","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":27144,"rule_id":"v8U0rZ","rv_id":1236400,"url":"https://semgrep.dev/playground/r/zyTb9Oq/java.lang.security.audit.active-debug-code-printstacktrace.active-debug-code-printstacktrace","version_id":"zyTb9Oq"}}},"severity":"WARNING","fingerprint":"a831f9c99505ae5c422c555c991cf84f39d7b00dd2871e4186b9b19999ea4d807452d60d731ca8fd1f23bc87a07675a49525e1ec7879735f40f4775da52e9cef_2","lines":"            e.printStackTrace();","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"java.lang.security.audit.crypto.ecb-cipher.ecb-cipher","path":"/Users/prooijendijk/Documents/explainify/java_dataset/java_files/StandardSecurityHandler.java","start":{"line":304,"col":13,"offset":10890},"end":{"line":304,"col":69,"offset":10946},"extra":{"metavars":{"$VAR":{"start":{"line":304,"col":20,"offset":10897},"end":{"line":304,"col":26,"offset":10903},"abstract_content":"cipher"},"$CIPHER":{"start":{"line":304,"col":29,"offset":10906},"end":{"line":304,"col":35,"offset":10912},"abstract_content":"Cipher Cipher Cipher"},"$MODE":{"start":{"line":304,"col":48,"offset":10925},"end":{"line":304,"col":67,"offset":10944},"abstract_content":"\"AES/ECB/NoPadding\""}},"message":"Cipher in ECB mode is detected. ECB mode produces the same output for the same input each time which allows an attacker to intercept and replay the data. Further, ECB mode does not provide any integrity checking. See https://find-sec-bugs.github.io/bugs.htm#CIPHER_INTEGRITY.","metadata":{"functional-categories":["crypto::search::mode::javax.crypto"],"cwe":["CWE-327: Use of a Broken or Risky Cryptographic Algorithm"],"owasp":["A03:2017 - Sensitive Data Exposure","A02:2021 - Cryptographic Failures","A04:2025 - Cryptographic Failures"],"source-rule-url":"https://find-sec-bugs.github.io/bugs.htm#ECB_MODE","category":"security","technology":["java"],"references":["https://owasp.org/Top10/A02_2021-Cryptographic_Failures"],"subcategory":["vuln"],"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"HIGH","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Cryptographic Issues"],"source":"https://semgrep.dev/r/java.lang.security.audit.crypto.ecb-cipher.ecb-cipher","shortlink":"https://sg.run/Ro9K","semgrep.dev":{"rule":{"origin":"community","r_id":9193,"rule_id":"5rUOb6","rv_id":1262998,"url":"https://semgrep.dev/playground/r/DkTRbwL/java.lang.security.audit.crypto.ecb-cipher.ecb-cipher","version_id":"DkTRbwL"}}},"severity":"WARNING","fingerprint":"b40477933d2a24e4a0e960380d02ecc3e475e19faeca81a0abfb25d18239eb212fb93060afe00352ac409b52955a14ac0f02dcde27ea2a810d1d75904db3b5a6_0","lines":"            Cipher cipher = Cipher.getInstance(\"AES/ECB/NoPadding\");","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"java.lang.security.audit.crypto.use-of-aes-ecb.use-of-aes-ecb","path":"/Users/prooijendijk/Documents/explainify/java_dataset/java_files/StandardSecurityHandler.java","start":{"line":304,"col":29,"offset":10906},"end":{"line":304,"col":68,"offset":10945},"extra":{"metavars":{"$CIPHER":{"start":{"line":304,"col":29,"offset":10906},"end":{"line":304,"col":35,"offset":10912},"abstract_content":"Cipher"}},"message":"Use of AES with ECB mode detected. ECB doesn't provide message confidentiality and  is not semantically secure so should not be used. Instead, use a strong, secure cipher: Cipher.getInstance(\"AES/CBC/PKCS7PADDING\"). See https://owasp.org/www-community/Using_the_Java_Cryptographic_Extensions for more information.","metadata":{"functional-categories":["crypto::search::mode::javax.crypto"],"cwe":["CWE-327: Use of a Broken or Risky Cryptographic Algorithm"],"owasp":["A03:2017 - Sensitive Data Exposure","A02:2021 - Cryptographic Failures","A04:2025 - Cryptographic Failures"],"category":"security","technology":["java"],"references":["https://owasp.org/Top10/A02_2021-Cryptographic_Failures","https://googleprojectzero.blogspot.com/2022/10/rc4-is-still-considered-harmful.html"],"subcategory":["vuln"],"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"HIGH","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Cryptographic Issues"],"source":"https://semgrep.dev/r/java.lang.security.audit.crypto.use-of-aes-ecb.use-of-aes-ecb","shortlink":"https://sg.run/dB2Y","semgrep.dev":{"rule":{"origin":"community","r_id":48734,"rule_id":"WAU2yA","rv_id":1263009,"url":"https://semgrep.dev/playground/r/A8TgdEo/java.lang.security.audit.crypto.use-of-aes-ecb.use-of-aes-ecb","version_id":"A8TgdEo"}}},"severity":"WARNING","fingerprint":"a6c905dfda447a452c66da1b00934e9cb51a3eb6615326f9336b0bf022a864d73b12129ca73162895128ab8df43a339fdb8753504d89efaa5b777237a8498677_0","lines":"            Cipher cipher = Cipher.getInstance(\"AES/ECB/NoPadding\");","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"java.lang.security.audit.xxe.saxparserfactory-disallow-doctype-decl-missing.saxparserfactory-disallow-doctype-decl-missing","path":"/Users/prooijendijk/Documents/explainify/java_dataset/java_files/XmlConverter.java","start":{"line":607,"col":13,"offset":23592},"end":{"line":607,"col":56,"offset":23635},"extra":{"metavars":{"$FACTORY":{"start":{"line":593,"col":17,"offset":22711},"end":{"line":593,"col":25,"offset":22719},"abstract_content":"sfactory"}},"message":"DOCTYPE declarations are enabled for this SAXParserFactory. This is vulnerable to XML external entity attacks. Disable this by setting the feature `http://apache.org/xml/features/disallow-doctype-decl` to true. Alternatively, allow DOCTYPE declarations and only prohibit external entities declarations. This can be done by setting the features `http://xml.org/sax/features/external-general-entities` and `http://xml.org/sax/features/external-parameter-entities` to false. NOTE - The previous links are not meant to be clicked. They are the literal config key values that are supposed to be used to disable these features. For more information, see https://semgrep.dev/docs/cheat-sheets/java-xxe/#3a-documentbuilderfactory.","fix":"sfactory.setFeature(\"http://apache.org/xml/features/disallow-doctype-decl\", true);\n            sfactory.newSAXParser();","metadata":{"cwe":["CWE-611: Improper Restriction of XML External Entity Reference"],"owasp":["A04:2017 - XML External Entities (XXE)","A05:2021 - Security Misconfiguration","A02:2025 - Security Misconfiguration"],"asvs":{"control_id":"5.5.2 Insecue XML Deserialization","control_url":"https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v55-deserialization-prevention","section":"V5 Validation, Sanitization and Encoding","version":"4"},"references":["https://semgrep.dev/blog/2022/xml-security-in-java","https://semgrep.dev/docs/cheat-sheets/java-xxe/","https://blog.sonarsource.com/secure-xml-processor","https://xerces.apache.org/xerces2-j/features.html"],"category":"security","technology":["java","xml"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"LOW","impact":"HIGH","confidence":"HIGH","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["XML Injection"],"source":"https://semgrep.dev/r/java.lang.security.audit.xxe.saxparserfactory-disallow-doctype-decl-missing.saxparserfactory-disallow-doctype-decl-missing","shortlink":"https://sg.run/Gj32","semgrep.dev":{"rule":{"origin":"community","r_id":59048,"rule_id":"j2Udpk","rv_id":1263061,"url":"https://semgrep.dev/playground/r/YDTZeko/java.lang.security.audit.xxe.saxparserfactory-disallow-doctype-decl-missing.saxparserfactory-disallow-doctype-decl-missing","version_id":"YDTZeko"}}},"severity":"ERROR","fingerprint":"589dff810efe2bde2ae59a4febedda3d93a0a2875c99b68ddaa4774e3c25ed99cde96f2d6c61d4bbd291c33adf75a64895f9cb2d3a6ee1a8f376033b8fcb83c7_0","lines":"            SAXParser parser = sfactory.newSAXParser();","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"/Users/prooijendijk/Documents/explainify/java_dataset/java_files/XmlConverter.java","start":{"line":593,"col":17,"offset":22711},"end":{"line":593,"col":59,"offset":22753}},"sfactory = SAXParserFactory.newInstance();"]],"intermediate_vars":[{"location":{"path":"/Users/prooijendijk/Documents/explainify/java_dataset/java_files/XmlConverter.java","start":{"line":593,"col":17,"offset":22711},"end":{"line":593,"col":25,"offset":22719}},"content":"sfactory"}],"taint_sink":["CliLoc",[{"path":"/Users/prooijendijk/Documents/explainify/java_dataset/java_files/XmlConverter.java","start":{"line":607,"col":13,"offset":23592},"end":{"line":607,"col":56,"offset":23635}},"SAXParser parser = sfactory.newSAXParser();"]]},"engine_kind":"OSS"}},{"check_id":"java.lang.security.xxe.xmlreader-xxe-parameter-entities.xmlreader-xxe-parameter-entities","path":"/Users/prooijendijk/Documents/explainify/java_dataset/java_files/XmlConverter.java","start":{"line":608,"col":13,"offset":23648},"end":{"line":608,"col":47,"offset":23682},"extra":{"metavars":{"$PARSER":{"start":{"line":608,"col":13,"offset":23648},"end":{"line":608,"col":22,"offset":23657},"abstract_content":"xmlReader"},"$S":{"start":{"line":608,"col":25,"offset":23660},"end":{"line":608,"col":31,"offset":23666},"abstract_content":"parser","propagated_value":{"svalue_start":{"line":607,"col":32,"offset":23611},"svalue_end":{"line":607,"col":55,"offset":23634},"svalue_abstract_content":"sfactory.newSAXParser()"}},"$X":{"start":{"line":608,"col":25,"offset":23660},"end":{"line":608,"col":31,"offset":23666},"abstract_content":"parser","propagated_value":{"svalue_start":{"line":607,"col":32,"offset":23611},"svalue_end":{"line":607,"col":55,"offset":23634},"svalue_abstract_content":"sfactory.newSAXParser()"}},"$CREATE":{"start":{"line":608,"col":32,"offset":23667},"end":{"line":608,"col":44,"offset":23679},"abstract_content":"getXMLReader"}},"message":"The application is using an XML parser that has not been safely configured. This might lead to XML External Entity (XXE) vulnerabilities when parsing user-controlled input. An attacker can include document type definitions (DTDs) which can interact with internal or external hosts. XXE can lead to other vulnerabilities, such as Local File Inclusion (LFI), Remote Code Execution (RCE), and Server- side request forgery (SSRF), depending on the application configuration. An attacker can also use DTDs to expand recursively, leading to a Denial-of-Service (DoS) attack, also known as a Billion Laughs Attack. It is our recommendation to secure this parser against XXE attacks through parameter entities by configuring $FACTORY with `xmlReader.setFeature(http://apache.org/xml/features/disallow- doctype-decl, true)`. Alternatively, the following configurations also provide protection against XXE attacks. `xmlReader.setProperty(XMLConstants.ACCESS_EXTERNAL_DTD, \"\")` `xmlReader.setFeature(\"http:// xml.org/sax/features/external-parameter-entities\", false)`. For more information, see: [Java XXE prevention](https://semgrep.dev/docs/cheat-sheets/java-xxe/)","metadata":{"likelihood":"MEDIUM","impact":"HIGH","confidence":"MEDIUM","category":"security","subcategory":["vuln"],"cwe":["CWE-611: Improper Restriction of XML External Entity Reference","CWE-776: Improper Restriction of Recursive Entity References in DTDs ('XML Entity Expansion')"],"functional-categories":["xml::sink::xml-parser::javax.xml","xml::sink::xml-parser::xml.sax"],"owasp":["A04:2017 - XML External Entities (XXE)","A05:2021 - Security Misconfiguration","A02:2025 - Security Misconfiguration"],"references":["https://semgrep.dev/blog/2022/xml-security-in-java","https://semgrep.dev/docs/cheat-sheets/java-xxe/","https://docs.oracle.com/en/java/javase/13/security/java-api-xml-processing-jaxp-security-guide.html#GUID-D97A1F1D-8DDF-4D19-A7E5-99099F27346E","https://github.com/semgrep/java-xxe-research","https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html","https://rules.sonarsource.com/java/type/Vulnerability/RSPEC-2755","https://blog.sonarsource.com/secure-xml-processor/","https://blog.sonarsource.com/understanding-xxe-vulnerabilities/","https://cwe.mitre.org/data/definitions/776.html","https://cwe.mitre.org/data/definitions/776.html"],"technology":["java"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["XML Injection"],"source":"https://semgrep.dev/r/java.lang.security.xxe.xmlreader-xxe-parameter-entities.xmlreader-xxe-parameter-entities","shortlink":"https://sg.run/oLqR","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":27160,"rule_id":"ReU0Dk","rv_id":1236426,"url":"https://semgrep.dev/playground/r/3ZT4gZz/java.lang.security.xxe.xmlreader-xxe-parameter-entities.xmlreader-xxe-parameter-entities","version_id":"3ZT4gZz"}}},"severity":"ERROR","fingerprint":"5f57d5ede25d1026b56fd9fc3b6edaefcd103fcfde2590cf6514fb35896d70a33d554a0ab879a16c58924de9e43569256ef06b45929b1f01dc3ef0f2603d3799_0","lines":"            xmlReader = parser.getXMLReader();","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"java.lang.security.xxe.xmlreader-xxe.xmlreader-xxe","path":"/Users/prooijendijk/Documents/explainify/java_dataset/java_files/XmlConverter.java","start":{"line":608,"col":13,"offset":23648},"end":{"line":608,"col":47,"offset":23682},"extra":{"metavars":{"$PARSER":{"start":{"line":608,"col":13,"offset":23648},"end":{"line":608,"col":22,"offset":23657},"abstract_content":"xmlReader"},"$S":{"start":{"line":608,"col":25,"offset":23660},"end":{"line":608,"col":31,"offset":23666},"abstract_content":"parser","propagated_value":{"svalue_start":{"line":607,"col":32,"offset":23611},"svalue_end":{"line":607,"col":55,"offset":23634},"svalue_abstract_content":"sfactory.newSAXParser()"}},"$X":{"start":{"line":608,"col":25,"offset":23660},"end":{"line":608,"col":31,"offset":23666},"abstract_content":"parser","propagated_value":{"svalue_start":{"line":607,"col":32,"offset":23611},"svalue_end":{"line":607,"col":55,"offset":23634},"svalue_abstract_content":"sfactory.newSAXParser()"}},"$CREATE":{"start":{"line":608,"col":32,"offset":23667},"end":{"line":608,"col":44,"offset":23679},"abstract_content":"getXMLReader"}},"message":"The application is using an XML parser that has not been safely configured. This might lead to XML External Entity (XXE) vulnerabilities when parsing user-controlled input. An attacker can include document type definitions (DTDs) which can interact with internal or external hosts. XXE can lead to other vulnerabilities, such as Local File Inclusion (LFI), Remote Code Execution (RCE), and Server-side request forgery (SSRF), depending on the application configuration. An attacker can also use DTDs to expand recursively, leading to a Denial-of-Service (DoS) attack, also known as a Billion Laughs Attack. It is our recommendation to secure this parser against XXE attacks by configuring $FACTORY with `xmlReader.setFeature(http://apache.org/xml/features/disallow-doctype-decl, true)`. Alternatively, the following configurations also provide protection against XXE attacks. `xmlReader.setProperty(XMLConstants.ACCESS_EXTERNAL_DTD, \"\")` `xmlReader.setFeature(\"http://xml.org/ sax/features/external-general-entities\", false)`. For more information, see: [Java XXE prevention] (https://semgrep.dev/docs/cheat-sheets/java-xxe/)","metadata":{"likelihood":"MEDIUM","impact":"HIGH","confidence":"MEDIUM","category":"security","subcategory":["vuln"],"cwe":["CWE-611: Improper Restriction of XML External Entity Reference","CWE-776: Improper Restriction of Recursive Entity References in DTDs ('XML Entity Expansion')"],"functional-categories":["xml::sink::xml-parser::javax.xml","xml::sink::xml-parser::xml.sax"],"owasp":["A04:2017 - XML External Entities (XXE)","A05:2021 - Security Misconfiguration","A02:2025 - Security Misconfiguration"],"references":["https://semgrep.dev/blog/2022/xml-security-in-java","https://semgrep.dev/docs/cheat-sheets/java-xxe/","https://docs.oracle.com/en/java/javase/13/security/java-api-xml-processing-jaxp-security-guide.html#GUID-D97A1F1D-8DDF-4D19-A7E5-99099F27346E","https://github.com/semgrep/java-xxe-research","https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html","https://rules.sonarsource.com/java/type/Vulnerability/RSPEC-2755","https://blog.sonarsource.com/secure-xml-processor/","https://blog.sonarsource.com/understanding-xxe-vulnerabilities/","https://cwe.mitre.org/data/definitions/776.html","https://cwe.mitre.org/data/definitions/776.html"],"technology":["java"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["XML Injection"],"source":"https://semgrep.dev/r/java.lang.security.xxe.xmlreader-xxe.xmlreader-xxe","shortlink":"https://sg.run/zLdW","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":27161,"rule_id":"AbUg9X","rv_id":1236427,"url":"https://semgrep.dev/playground/r/44TEJBL/java.lang.security.xxe.xmlreader-xxe.xmlreader-xxe","version_id":"44TEJBL"}}},"severity":"ERROR","fingerprint":"d4aaeddfd44da2009dc635352c580f5df591599b2b1cc556317a7b35825a74ca920ac5a2f0f7357ee91d25b819d28a771884d116126e0f980ccf730afa98fec0_0","lines":"            xmlReader = parser.getXMLReader();","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}}],"errors":[],"paths":{"scanned":["/Users/prooijendijk/Documents/explainify/java_dataset/java_files/AbstractAtomProvider.java","/Users/prooijendijk/Documents/explainify/java_dataset/java_files/AbstractSAMLCallbackHandler.java","/Users/prooijendijk/Documents/explainify/java_dataset/java_files/AtomPojoProviderTest.java","/Users/prooijendijk/Documents/explainify/java_dataset/java_files/COSArray.java","/Users/prooijendijk/Documents/explainify/java_dataset/java_files/CombinedValidatorTest.java","/Users/prooijendijk/Documents/explainify/java_dataset/java_files/DefaultURLConstructor.java","/Users/prooijendijk/Documents/explainify/java_dataset/java_files/DiskFileItem.java","/Users/prooijendijk/Documents/explainify/java_dataset/java_files/DiskFileItemSerializeTest.java","/Users/prooijendijk/Documents/explainify/java_dataset/java_files/Expander.java","/Users/prooijendijk/Documents/explainify/java_dataset/java_files/ExpanderTest.java","/Users/prooijendijk/Documents/explainify/java_dataset/java_files/FileUploadBase.java","/Users/prooijendijk/Documents/explainify/java_dataset/java_files/FilenameUtils.java","/Users/prooijendijk/Documents/explainify/java_dataset/java_files/FilenameUtilsTestCase.java","/Users/prooijendijk/Documents/explainify/java_dataset/java_files/Issue1005.java","/Users/prooijendijk/Documents/explainify/java_dataset/java_files/JpegDecoder.java","/Users/prooijendijk/Documents/explainify/java_dataset/java_files/JpegDecoderTest.java","/Users/prooijendijk/Documents/explainify/java_dataset/java_files/Maven221MultiVolumeTest.java","/Users/prooijendijk/Documents/explainify/java_dataset/java_files/MultipartStream.java","/Users/prooijendijk/Documents/explainify/java_dataset/java_files/MultipartStreamTest.java","/Users/prooijendijk/Documents/explainify/java_dataset/java_files/NioZipEncoding.java","/Users/prooijendijk/Documents/explainify/java_dataset/java_files/NioZipEncodingTest.java","/Users/prooijendijk/Documents/explainify/java_dataset/java_files/ObjectArrayCodec.java","/Users/prooijendijk/Documents/explainify/java_dataset/java_files/RgbeInfo.java","/Users/prooijendijk/Documents/explainify/java_dataset/java_files/RgbeReadTest.java","/Users/prooijendijk/Documents/explainify/java_dataset/java_files/SAMLSSOResponseValidator.java","/Users/prooijendijk/Documents/explainify/java_dataset/java_files/SAXDocumentFactory.java","/Users/prooijendijk/Documents/explainify/java_dataset/java_files/SaxonXsltDTDTest.java","/Users/prooijendijk/Documents/explainify/java_dataset/java_files/StandardSecurityHandler.java","/Users/prooijendijk/Documents/explainify/java_dataset/java_files/TestURIBuilder.java","/Users/prooijendijk/Documents/explainify/java_dataset/java_files/TestYAMLConfiguration.java","/Users/prooijendijk/Documents/explainify/java_dataset/java_files/URIBuilder.java","/Users/prooijendijk/Documents/explainify/java_dataset/java_files/WikiServletTest.java","/Users/prooijendijk/Documents/explainify/java_dataset/java_files/X0017_StrongEncryptionHeader.java","/Users/prooijendijk/Documents/explainify/java_dataset/java_files/XPathBuilder.java","/Users/prooijendijk/Documents/explainify/java_dataset/java_files/XPathFeatureTest.java","/Users/prooijendijk/Documents/explainify/java_dataset/java_files/XmlConverter.java","/Users/prooijendijk/Documents/explainify/java_dataset/java_files/XsltDTDTest.java","/Users/prooijendijk/Documents/explainify/java_dataset/java_files/YAMLConfiguration.java","/Users/prooijendijk/Documents/explainify/java_dataset/java_files/ZipArchiveInputStream.java","/Users/prooijendijk/Documents/explainify/java_dataset/java_files/ZipArchiveInputStreamTest.java"],"skipped":[]},"time":{"rules":[],"rules_parse_time":5.00241494178772,"profiling_times":{"config_time":13.554594039916992,"core_time":6.726016044616699,"ignores_time":0.0012481212615966797,"total_time":20.282226085662842},"parsing_time":{"total_time":0.0,"per_file_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"scanning_time":{"total_time":7.609174728393555,"per_file_time":{"mean":0.06340978940327967,"std_dev":0.021143950924272046},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"matching_time":{"total_time":0.0,"per_file_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_files":[]},"tainting_time":{"total_time":0.0,"per_def_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_defs":[]},"fixpoint_timeouts":[],"prefiltering":{"project_level_time":0.0,"file_level_time":0.0,"rules_with_project_prefilters_ratio":0.0,"rules_with_file_prefilters_ratio":0.9743589743589743,"rules_selected_ratio":0.09463141025641025,"rules_matched_ratio":0.09463141025641025},"targets":[],"total_bytes":0,"max_memory_bytes":8854622016},"engine_requested":"OSS","interfile_languages_used":[],"skipped_rules":[]}