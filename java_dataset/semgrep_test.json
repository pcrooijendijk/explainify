{"version":"1.139.0","results":[{"check_id":"java.lang.security.xxe.documentbuilderfactory-xxe-parameter-entity.documentbuilderfactory-xxe-parameter-entity","path":"/Users/prooijendijk/Documents/explainify/java_dataset/java_files/AbstractSAMLCallbackHandler.java","start":{"line":203,"col":36,"offset":7979},"end":{"line":204,"col":53,"offset":8052},"extra":{"metavars":{"$FACTORY":{"start":{"line":203,"col":36,"offset":7979},"end":{"line":203,"col":53,"offset":7996},"abstract_content":"docBuilderFactory"},"$PARSER":{"start":{"line":206,"col":29,"offset":8137},"end":{"line":206,"col":39,"offset":8147},"abstract_content":"docBuilder"}},"message":"The application is using an XML parser that has not been safely configured. This might lead to XML External Entity (XXE) vulnerabilities when parsing user-controlled input. An attacker can include document type definitions (DTDs) which can interact with internal or external hosts. XXE can lead to other vulnerabilities, such as Local File Inclusion (LFI), Remote Code Execution (RCE), and Server-side request forgery (SSRF), depending on the application configuration. An attacker can also use DTDs to expand recursively, leading to a Denial-of-Service (DoS) attack, also known as a Billion Laughs Attack. The current configuration allows for XXE attacks through parameter entities. It is our recommendation to secure this parser against XXE attacks by configuring docBuilderFactory with `docBuilderFactory.setFeature(http://apache.org/xml/features/disallow-doctype- decl, true)`. Alternatively, the following configurations also provide protection against XXE attacks with parameter entities. `docBuilderFactory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true)` `docBuilderFactory.setAttribute(XMLConstants.ACCESS_EXTERNAL_DTD, \"\")` `docBuilderFactory.setFeature(\"http://xml.org/ sax/features/external-parameter-entities\", false)` Beware, using a custom EntityResolver will render these settings useless and you will be responsible for handeling security in the implementation of you EntityResolver. For more information, see: [Java XXE prevention](https://semgrep.dev/docs/cheat- sheets/java-xxe/)","metadata":{"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"MEDIUM","category":"security","subcategory":["vuln"],"cwe":["CWE-611: Improper Restriction of XML External Entity Reference","CWE-776: Improper Restriction of Recursive Entity References in DTDs ('XML Entity Expansion')"],"functional-categories":["xml::sink::xml-parser::javax.xml"],"owasp":["A04:2017 - XML External Entities (XXE)","A05:2021 - Security Misconfiguration","A02:2025 - Security Misconfiguration"],"references":["https://semgrep.dev/blog/2022/xml-security-in-java","https://semgrep.dev/docs/cheat-sheets/java-xxe/","https://docs.oracle.com/en/java/javase/13/security/java-api-xml-processing-jaxp-security-guide.html#GUID-D97A1F1D-8DDF-4D19-A7E5-99099F27346E","https://github.com/semgrep/java-xxe-research","https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html","https://rules.sonarsource.com/java/type/Vulnerability/RSPEC-2755","https://blog.sonarsource.com/secure-xml-processor/","https://blog.sonarsource.com/understanding-xxe-vulnerabilities/","https://cwe.mitre.org/data/definitions/776.html","https://cwe.mitre.org/data/definitions/776.html"],"technology":["java"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["XML Injection"],"source":"https://semgrep.dev/r/java.lang.security.xxe.documentbuilderfactory-xxe-parameter-entity.documentbuilderfactory-xxe-parameter-entity","shortlink":"https://sg.run/5qYX","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":27147,"rule_id":"nJU2Wq","rv_id":1236412,"url":"https://semgrep.dev/playground/r/w8TRvEn/java.lang.security.xxe.documentbuilderfactory-xxe-parameter-entity.documentbuilderfactory-xxe-parameter-entity","version_id":"w8TRvEn"}}},"severity":"ERROR","fingerprint":"f00b803522ad89fa9dce38eddae5e1aa3164a98294d1e8d45e0216512a92c3461d7c7406d4801126a3a8a9d1324246e5ea6bb935a1d0976b6ba5d0057605061a_0","lines":"            DocumentBuilderFactory docBuilderFactory = \n                DocumentBuilderFactory.newInstance();","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"java.lang.security.xxe.documentbuilderfactory-xxe.documentbuilderfactory-xxe","path":"/Users/prooijendijk/Documents/explainify/java_dataset/java_files/AbstractSAMLCallbackHandler.java","start":{"line":203,"col":36,"offset":7979},"end":{"line":204,"col":53,"offset":8052},"extra":{"metavars":{"$FACTORY":{"start":{"line":203,"col":36,"offset":7979},"end":{"line":203,"col":53,"offset":7996},"abstract_content":"docBuilderFactory"},"$PARSER":{"start":{"line":206,"col":29,"offset":8137},"end":{"line":206,"col":39,"offset":8147},"abstract_content":"docBuilder"}},"message":"The application is using an XML parser that has not been safely configured. This might lead to XML External Entity (XXE) vulnerabilities when parsing user-controlled input. An attacker can include document type definitions (DTDs) which can interact with internal or external hosts. XXE can lead to other vulnerabilities, such as Local File Inclusion (LFI), Remote Code Execution (RCE), and Server-side request forgery (SSRF), depending on the application configuration. An attacker can also use DTDs to expand recursively, leading to a Denial-of- Service (DoS) attack, also known as a Billion Laughs Attack. It is our recommendation to secure this parser against XXE attacks by configuring docBuilderFactory with `docBuilderFactory.setFeature(http:// apache.org/ xml/features/disallow-doctype-decl, true)`. Alternatively, the following configurations also provide protection against XXE attacks. `docBuilderFactory.setExpandEntityReferences(false)` `docBuilderFactory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true)` `docBuilderFactory.setAttribute(XMLConstants.ACCESS_EXTERNAL_DTD, \"\")` `docBuilderFactory.setFeature(\"http://xml.org/ sax/features/external-general-entities\", false)`. For more information, see: [Java XXE prevention] (https://semgrep.dev/docs/cheat-sheets/java-xxe/)","metadata":{"likelihood":"MEDIUM","impact":"HIGH","confidence":"MEDIUM","category":"security","subcategory":["vuln"],"cwe":["CWE-611: Improper Restriction of XML External Entity Reference","CWE-776: Improper Restriction of Recursive Entity References in DTDs ('XML Entity Expansion')"],"functional-categories":["xml::sink::xml-parser::javax.xml"],"owasp":["A04:2017 - XML External Entities (XXE)","A05:2021 - Security Misconfiguration","A02:2025 - Security Misconfiguration"],"references":["https://semgrep.dev/blog/2022/xml-security-in-java","https://semgrep.dev/docs/cheat-sheets/java-xxe/","https://docs.oracle.com/en/java/javase/13/security/java-api-xml-processing-jaxp-security-guide.html#GUID-D97A1F1D-8DDF-4D19-A7E5-99099F27346E","https://github.com/semgrep/java-xxe-research","https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html","https://rules.sonarsource.com/java/type/Vulnerability/RSPEC-2755","https://blog.sonarsource.com/secure-xml-processor/","https://blog.sonarsource.com/understanding-xxe-vulnerabilities/","https://cwe.mitre.org/data/definitions/776.html","https://cwe.mitre.org/data/definitions/776.html"],"technology":["java"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["XML Injection"],"source":"https://semgrep.dev/r/java.lang.security.xxe.documentbuilderfactory-xxe.documentbuilderfactory-xxe","shortlink":"https://sg.run/GJd2","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":27148,"rule_id":"EwUEj8","rv_id":1236414,"url":"https://semgrep.dev/playground/r/O9Tpr9p/java.lang.security.xxe.documentbuilderfactory-xxe.documentbuilderfactory-xxe","version_id":"O9Tpr9p"}}},"severity":"ERROR","fingerprint":"999f0681f78298cb26785f040e466845fd4047a9374e6d650f798264017e07c7cf036c2b41ef771d5919e07ff33d891a2fb1c40ffeaccf4954a25ca516797729_0","lines":"            DocumentBuilderFactory docBuilderFactory = \n                DocumentBuilderFactory.newInstance();","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"java.lang.security.audit.xxe.documentbuilderfactory-disallow-doctype-decl-missing.documentbuilderfactory-disallow-doctype-decl-missing","path":"/Users/prooijendijk/Documents/explainify/java_dataset/java_files/AbstractSAMLCallbackHandler.java","start":{"line":206,"col":13,"offset":8121},"end":{"line":206,"col":81,"offset":8189},"extra":{"metavars":{"$FACTORY":{"start":{"line":203,"col":36,"offset":7979},"end":{"line":203,"col":53,"offset":7996},"abstract_content":"docBuilderFactory"}},"message":"DOCTYPE declarations are enabled for this DocumentBuilderFactory. This is vulnerable to XML external entity attacks. Disable this by setting the feature \"http://apache.org/xml/features/disallow-doctype-decl\" to true. Alternatively, allow DOCTYPE declarations and only prohibit external entities declarations. This can be done by setting the features \"http://xml.org/sax/features/external-general-entities\" and \"http://xml.org/sax/features/external-parameter-entities\" to false.","fix":"docBuilderFactory.setFeature(\"http://apache.org/xml/features/disallow-doctype-decl\", true);\n            docBuilderFactory.newDocumentBuilder();","metadata":{"cwe":["CWE-611: Improper Restriction of XML External Entity Reference"],"owasp":["A04:2017 - XML External Entities (XXE)","A05:2021 - Security Misconfiguration","A02:2025 - Security Misconfiguration"],"asvs":{"control_id":"5.5.2 Insecue XML Deserialization","control_url":"https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v55-deserialization-prevention","section":"V5 Validation, Sanitization and Encoding","version":"4"},"references":["https://semgrep.dev/blog/2022/xml-security-in-java","https://semgrep.dev/docs/cheat-sheets/java-xxe/","https://blog.sonarsource.com/secure-xml-processor","https://xerces.apache.org/xerces2-j/features.html"],"category":"security","technology":["java","xml"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"LOW","impact":"HIGH","confidence":"HIGH","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["XML Injection"],"source":"https://semgrep.dev/r/java.lang.security.audit.xxe.documentbuilderfactory-disallow-doctype-decl-missing.documentbuilderfactory-disallow-doctype-decl-missing","shortlink":"https://sg.run/PYBz","semgrep.dev":{"rule":{"origin":"community","r_id":18245,"rule_id":"10UPQB","rv_id":1263058,"url":"https://semgrep.dev/playground/r/K3TKk80/java.lang.security.audit.xxe.documentbuilderfactory-disallow-doctype-decl-missing.documentbuilderfactory-disallow-doctype-decl-missing","version_id":"K3TKk80"}}},"severity":"ERROR","fingerprint":"71ae12ad3b94a44e543c014b2bfa28487dc46bcac7954eaaaa5db116154a4fa6c8ba57ac284a091bdd05ffc1d903054f9080e56d785f095bd9538ad53649a9d6_0","lines":"            DocumentBuilder docBuilder = docBuilderFactory.newDocumentBuilder();","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"/Users/prooijendijk/Documents/explainify/java_dataset/java_files/AbstractSAMLCallbackHandler.java","start":{"line":203,"col":13,"offset":7956},"end":{"line":204,"col":54,"offset":8053}},"DocumentBuilderFactory docBuilderFactory = \n                DocumentBuilderFactory.newInstance();"]],"intermediate_vars":[{"location":{"path":"/Users/prooijendijk/Documents/explainify/java_dataset/java_files/AbstractSAMLCallbackHandler.java","start":{"line":203,"col":36,"offset":7979},"end":{"line":203,"col":53,"offset":7996}},"content":"docBuilderFactory"}],"taint_sink":["CliLoc",[{"path":"/Users/prooijendijk/Documents/explainify/java_dataset/java_files/AbstractSAMLCallbackHandler.java","start":{"line":206,"col":13,"offset":8121},"end":{"line":206,"col":81,"offset":8189}},"DocumentBuilder docBuilder = docBuilderFactory.newDocumentBuilder();"]]},"engine_kind":"OSS"}}],"errors":[],"paths":{"scanned":["/Users/prooijendijk/Documents/explainify/java_dataset/java_files/AbstractSAMLCallbackHandler.java"],"skipped":[]},"time":{"rules":[],"rules_parse_time":5.014274835586548,"profiling_times":{"config_time":6.551040172576904,"core_time":5.932683944702148,"ignores_time":0.0012378692626953125,"total_time":12.48534893989563},"parsing_time":{"total_time":0.0,"per_file_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"scanning_time":{"total_time":0.06285405158996582,"per_file_time":{"mean":0.020951350529988606,"std_dev":0.0007754805835828746},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"matching_time":{"total_time":0.0,"per_file_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_files":[]},"tainting_time":{"total_time":0.0,"per_def_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_defs":[]},"fixpoint_timeouts":[],"prefiltering":{"project_level_time":0.0,"file_level_time":0.0,"rules_with_project_prefilters_ratio":0.0,"rules_with_file_prefilters_ratio":0.9743589743589743,"rules_selected_ratio":0.09294871794871795,"rules_matched_ratio":0.09294871794871795},"targets":[],"total_bytes":0,"max_memory_bytes":8860306624},"engine_requested":"OSS","interfile_languages_used":[],"skipped_rules":[]}